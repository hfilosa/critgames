<!DOCTYPE html>
<html lang = "en-US">
 <head>
 <meta charset = "UTF-8">
 <title>test.html</title>

 <link rel="stylesheet" href="flipclock/flipclock.css">
 <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
 <script src="flipclock/flipclock.js"></script>

 <script type = "text/javascript">
   jQuery.fn.shake = function() {
    this.each(function(i) {
        $(this).css({ "position": "relative" });
        for (var x = 1; x <= 3; x++) {
            $(this).animate({ left: -25 }, 10).animate({ left: 0 }, 50).animate({ left: 25 }, 10).animate({ left: 0 }, 50);
            $(this).animate({ top: -25 }, 10).animate({ top: 0 }, 50).animate({ top: 25 }, 10).animate({ top: 0 }, 50);
        }
    });
    return this;
  }
  // from textBoxes.html
  var words = new Map();
  //Define all words here
  words.set("look_menu",["menu","grab menu","look at menu","gaze at menu","stare at menu","pick up menu"]);
  words.set("read",["read","comprehend","decipher"]);
  words.set("order",["order","ask","demand"]);
  words.set("ask",["ask","help","recommend","recommendation"]);
  words.set("excuse",["excuse"])
  //global states
  var cur_state = meal_start;
  var concern = 0;
  var input;
  var output;
  var timer;
  var time;
  var narrator;
  //Shake demonstration
  window.setInterval(function(){
    if (concern>1)
      $("#shake").shake();
  }, 1000);

  function main(){
    input = document.getElementById("input").value.toLowerCase().trim();
    output = document.getElementById("output");
    narrator = document.getElementById("narrator");
    time = timer.getTime();
    cur_state();
  }

  //return if word is present in some form in input
  function word_present(input,word){
    var synonyms = words.get(word);
    for (n in synonyms){
      if (input.includes(synonyms[n]))
        return true;
    }
    return false;
  }
  //Getters & Setters
  function narrate(text){
    narrator.innerHTML = text;
  }
  function set_state(state){
    cur_state = state;
  }

  function meal_start(){
    if (word_present(input,"look_menu")){
      output.innerHTML = "show menu";
      set_state(menu_look);
      return;
    }
  }
  function menu_look(){
    if (word_present(input,"read"))
      narrate("you can’t read the menu items because you’re so anxious");
    else
      set_state(stage1);
  }
  function stage1(){
    if (input == "order"){
      narrate("order what?");
      return;
    }
    if (word_present(input,"order")){
      narrate("I don't think that's on the menu");
      return;
    }
    if (input == "order nothing"){
      concern += 3;
      narrate("WHAT! Game over");
      return;
    }
  }
  function stage2(){

  }
  function stage3(){

  }
 </script>

 </head>
 <body>
 <h1>Test of system</h1>
 <div id ="timer" class="clock" style="margin:2em;"></div>
 <script type="text/javascript">
   var clock;
   $(document).ready(function() {
     // Instantiate a counter
     clock = new FlipClock($('.clock'), 10, {
       clockFace: 'Counter',
       autoStart: true,
       countdown: true
     });
     timer = clock;
   });
 </script>

 <form action = "#" onsubmit="main()"
  <fieldset>
  <label>Input: </label>
  <br>
  <input type = "text"  id = "input" />
  <br>
  <label>Output: </label>
  <br>
  <h1 id="output">output here</h1>
  <br>
  <label>Narrator: </label>
  <br>
  <h1 id="narrator">Narrator</h1>
  <br>
  </fieldset>
 </form>
 <div class="horizontally">
 <div id="shake">fear2</div>
 </div>
 </body>
</html>
